#######################################################################################
# Author: Srijan Verma                                                              #
# School of Pharmacy                                                                #
# Sirimulla Research Group [http://www.sirimullaresearchgroup.com/]                 #
# The University of Texas at El Paso, TX, USA                                       #
# Last modified: 19/12/2019                                                         #
# Copyright (c) 2019 Srijan Verma and Sirimulla Research Group, under MIT license   #
#######################################################################################
from rdkit import Chem
from rdkit.Chem import MACCSkeys, AllChem
from rdkit.Avalon import pyAvalonTools as fpAvalon
from rdkit.Chem.AtomPairs import Pairs, Torsions
from rdkit.Chem.Fingerprints import FingerprintMols
from rdkit.Chem.ChemicalFeatures import BuildFeatureFactory
from rdkit.Chem import rdMolDescriptors

LocInfo_dict =[
{'1A1_ind': {'dataset_size': 1525,
'actives': 49,
'inactives': 1476,
'cohen_k_test': -0.008,
'cohen_k_val': 0.163,
'auc_1_test': 0.498,
'accuracy_test': 0.965,
'f1_score_1_test': 0.0},
'1A1_inh': {'dataset_size': 1525,
'actives': 45,
'inactives': 1480,
'cohen_k_test': -0.008,
'cohen_k_val': 0.349,
'auc_1_test': 0.498,
'accuracy_test': 0.965,
'f1_score_1_test': 0.0},
'1A1_sub': {'dataset_size': 1525,
'actives': 49,
'inactives': 1476,
'cohen_k_test': -0.023,
'cohen_k_val': 0.349,
'auc_1_test': 0.491,
'accuracy_test': 0.952,
'f1_score_1_test': 0.0},
'1A2_ind': {'dataset_size': 1525,
'actives': 39,
'inactives': 1486,
'cohen_k_test': 0.162,
'cohen_k_val': 0.288,
'auc_1_test': 0.574,
'accuracy_test': 0.961,
'f1_score_1_test': 0.182},
'1A2_inh': {'dataset_size': 1525,
'actives': 124,
'inactives': 1401,
'cohen_k_test': 0.07,
'cohen_k_val': 0.245,
'auc_1_test': 0.522,
'accuracy_test': 0.913,
'f1_score_1_test': 0.091},
'1A2_sub': {'dataset_size': 1525,
'actives': 314,
'inactives': 1211,
'cohen_k_test': 0.37,
'cohen_k_val': 0.438,
'auc_1_test': 0.669,
'accuracy_test': 0.812,
'f1_score_1_test': 0.482},
'2C19_ind': {'dataset_size': 1525,
'actives': 16,
'inactives': 1509,
'cohen_k_test': 0.566,
'cohen_k_val': 0.24,
'auc_1_test': 0.993,
'accuracy_test': 0.987,
'f1_score_1_test': 0.571},
'2C19_inh': {'dataset_size': 1525,
'actives': 109,
'inactives': 1416,
'cohen_k_test': 0.097,
'cohen_k_val': 0.301,
'auc_1_test': 0.529,
'accuracy_test': 0.93,
'f1_score_1_test': 0.111},
'2C19_sub': {'dataset_size': 1525,
'actives': 278,
'inactives': 1247,
'cohen_k_test': 0.266,
'cohen_k_val': 0.485,
'auc_1_test': 0.611,
'accuracy_test': 0.817,
'f1_score_1_test': 0.364},
'2C8_ind': {'dataset_size': 1525,
'actives': 17,
'inactives': 1508,
'cohen_k_test': 0.0,
'cohen_k_val': 1.0,
'auc_1_test': 0.5,
'accuracy_test': 0.987,
'f1_score_1_test': 0.0},
'2C8_inh': {'dataset_size': 1525,
'actives': 96,
'inactives': 1429,
'cohen_k_test': 0.032,
'cohen_k_val': 0.24,
'auc_1_test': 0.528,
'accuracy_test': 0.803,
'f1_score_1_test': 0.118},
'2C8_sub': {'dataset_size': 1525,
'actives': 189,
'inactives': 1336,
'cohen_k_test': 0.256,
'cohen_k_val': 0.501,
'auc_1_test': 0.595,
'accuracy_test': 0.882,
'f1_score_1_test': 0.308},
'2C9_ind': {'dataset_size': 1525,
'actives': 28,
'inactives': 1497,
'cohen_k_test': 0.275,
'cohen_k_val': 0.291,
'auc_1_test': 0.621,
'accuracy_test': 0.978,
'f1_score_1_test': 0.286},
'2C9_inh': {'dataset_size': 1525,
'actives': 220,
'inactives': 1305,
'cohen_k_test': 0.245,
'cohen_k_val': 0.353,
'auc_1_test': 0.638,
'accuracy_test': 0.79,
'f1_score_1_test': 0.368},
'2C9_sub': {'dataset_size': 1525,
'actives': 329,
'inactives': 1196,
'cohen_k_test': 0.38,
'cohen_k_val': 0.451,
'auc_1_test': 0.663,
'accuracy_test': 0.821,
'f1_score_1_test': 0.481},
'2D6_inh': {'dataset_size': 1525,
'actives': 245,
'inactives': 1280,
'cohen_k_test': 0.12,
'cohen_k_val': 0.349,
'auc_1_test': 0.584,
'accuracy_test': 0.668,
'f1_score_1_test': 0.309},
'2D6_sub': {'dataset_size': 1525,
'actives': 429,
'inactives': 1096,
'cohen_k_test': 0.372,
'cohen_k_val': 0.484,
'auc_1_test': 0.664,
'accuracy_test': 0.777,
'f1_score_1_test': 0.505},
'2E1_ind': {'dataset_size': 1525,
'actives': 28,
'inactives': 1497,
'cohen_k_test': 0.0,
'cohen_k_val': 0.396,
'auc_1_test': 0.5,
'accuracy_test': 0.983,
'f1_score_1_test': 0.0},
'2E1_inh': {'dataset_size': 1525,
'actives': 72,
'inactives': 1453,
'cohen_k_test': 0.121,
'cohen_k_val': 0.313,
'auc_1_test': 0.566,
'accuracy_test': 0.913,
'f1_score_1_test': 0.167},
'2E1_sub': {'dataset_size': 1525,
'actives': 169,
'inactives': 1356,
'cohen_k_test': 0.328,
'cohen_k_val': 0.514,
'auc_1_test': 0.615,
'accuracy_test': 0.908,
'f1_score_1_test': 0.364},
'3A4_ind': {'dataset_size': 1525,
'actives': 101,
'inactives': 1424,
'cohen_k_test': 0.073,
'cohen_k_val': 0.358,
'auc_1_test': 0.536,
'accuracy_test': 0.886,
'f1_score_1_test': 0.133},
'3A4_inh': {'dataset_size': 1525,
'actives': 313,
'inactives': 1212,
'cohen_k_test': 0.225,
'cohen_k_val': 0.264,
'auc_1_test': 0.59,
'accuracy_test': 0.799,
'f1_score_1_test': 0.324},
'3A4_sub': {'dataset_size': 1525,
'actives': 707,
'inactives': 818,
'cohen_k_test': 0.35,
'cohen_k_val': 0.565,
'auc_1_test': 0.673,
'accuracy_test': 0.681,
'f1_score_1_test': 0.618},
'3A5_ind': {'dataset_size': 1525,
'actives': 30,
'inactives': 1495,
'cohen_k_test': -0.02,
'cohen_k_val': 0.433,
'auc_1_test': 0.491,
'accuracy_test': 0.961,
'f1_score_1_test': 0.0},
'3A5_inh': {'dataset_size': 1525,
'actives': 29,
'inactives': 1496,
'cohen_k_test': 0.147,
'cohen_k_val': 0.349,
'auc_1_test': 0.609,
'accuracy_test': 0.956,
'f1_score_1_test': 0.167},
'3A5_sub': {'dataset_size': 1525,
'actives': 124,
'inactives': 1401,
'cohen_k_test': 0.128,
'cohen_k_val': 0.205,
'auc_1_test': 0.589,
'accuracy_test': 0.817,
'f1_score_1_test': 0.222},
'GST_ind': {'dataset_size': 1525,
'actives': 48,
'inactives': 1477,
'cohen_k_test': -0.023,
'cohen_k_val': 0.263,
'auc_1_test': 0.491,
'accuracy_test': 0.952,
'f1_score_1_test': 0.0},
'GST_inh': {'dataset_size': 1525,
'actives': 35,
'inactives': 1490,
'cohen_k_test': 0.0,
'cohen_k_val': 0.328,
'auc_1_test': 0.5,
'accuracy_test': 0.978,
'f1_score_1_test': 0.0},
'GST_sub': {'dataset_size': 1525,
'actives': 20,
'inactives': 1505,
'cohen_k_test': 0.0,
'cohen_k_val': 0.394,
'auc_1_test': 0.5,
'accuracy_test': 0.987,
'f1_score_1_test': 0.0},
'MET_ind': {'dataset_size': 1525,
'actives': 16,
'inactives': 1509,
'cohen_k_test': -0.011,
'cohen_k_val': 0.325,
'auc_1_test': 0.493,
'accuracy_test': 0.978,
'f1_score_1_test': 0.0},
'MET_inh': {'dataset_size': 1525,
'actives': 38,
'inactives': 1487,
'cohen_k_test': 0.225,
'cohen_k_val': 0.288,
'auc_1_test': 0.649,
'accuracy_test': 0.948,
'f1_score_1_test': 0.25},
'MET_sub': {'dataset_size': 1525,
'actives': 16,
'inactives': 1509,
'cohen_k_test': -0.009,
'cohen_k_val': 0.798,
'auc_1_test': 0.496,
'accuracy_test': 0.983,
'f1_score_1_test': 0.0},
'NAT_ind': {'dataset_size': 1525,
'actives': 30,
'inactives': 1495,
'cohen_k_test': -0.007,
'cohen_k_val': 0.237,
'auc_1_test': 0.498,
'accuracy_test': 0.974,
'f1_score_1_test': 0.0},
'NAT_inh': {'dataset_size': 1525,
'actives': 31,
'inactives': 1494,
'cohen_k_test': -0.017,
'cohen_k_val': 0.277,
'auc_1_test': 0.493,
'accuracy_test': 0.965,
'f1_score_1_test': 0.0},
'NAT_sub': {'dataset_size': 1525,
'actives': 19,
'inactives': 1506,
'cohen_k_test': 0.0,
'cohen_k_val': 0.662,
'auc_1_test': 0.5,
'accuracy_test': 0.987,
'f1_score_1_test': 0.0},
'SUL_ind': {'dataset_size': 1525,
'actives': 15,
'inactives': 1510,
'cohen_k_test': 0.0,
'cohen_k_val': 0.496,
'auc_1_test': 0.5,
'accuracy_test': 0.991,
'f1_score_1_test': 0.0},
'SUL_inh': {'dataset_size': 1525,
'actives': 17,
'inactives': 1508,
'cohen_k_test': -0.011,
'cohen_k_val': 0.665,
'auc_1_test': 0.496,
'accuracy_test': 0.978,
'f1_score_1_test': 0.0},
'SUL_sub': {'dataset_size': 1525,
'actives': 25,
'inactives': 1500,
'cohen_k_test': -0.012,
'cohen_k_val': 0.237,
'auc_1_test': 0.496,
'accuracy_test': 0.974,
'f1_score_1_test': 0.0},
'UGT_ind': {'dataset_size': 1525,
'actives': 20,
'inactives': 1505,
'cohen_k_test': -0.013,
'cohen_k_val': 0.497,
'auc_1_test': 0.493,
'accuracy_test': 0.974,
'f1_score_1_test': 0.0},
'UGT_inh': {'dataset_size': 1525,
'actives': 31,
'inactives': 1494,
'cohen_k_test': 0.0,
'cohen_k_val': 0.277,
'auc_1_test': 0.5,
'accuracy_test': 0.978,
'f1_score_1_test': 0.0},
'UGT_sub': {'dataset_size': 1525,
'actives': 66,
'inactives': 1459,
'cohen_k_test': 0.107,
'cohen_k_val': 0.45,
'auc_1_test': 0.541,
'accuracy_test': 0.943,
'f1_score_1_test': 0.133}}
]

nbits = 1024
longbits = 16384

# dictionary
fpFunc_dict = {}
fpFunc_dict['ecfp0'] = lambda m: AllChem.GetMorganFingerprintAsBitVect(m, 0, nBits=nbits)
fpFunc_dict['ecfp2'] = lambda m: AllChem.GetMorganFingerprintAsBitVect(m, 1, nBits=nbits)
fpFunc_dict['ecfp4'] = lambda m: AllChem.GetMorganFingerprintAsBitVect(m, 2, nBits=nbits)
fpFunc_dict['ecfp6'] = lambda m: AllChem.GetMorganFingerprintAsBitVect(m, 3, nBits=nbits)
fpFunc_dict['fcfp2'] = lambda m: AllChem.GetMorganFingerprintAsBitVect(m, 1, useFeatures=True, nBits=nbits)
fpFunc_dict['fcfp4'] = lambda m: AllChem.GetMorganFingerprintAsBitVect(m, 2, useFeatures=True, nBits=nbits)
fpFunc_dict['fcfp6'] = lambda m: AllChem.GetMorganFingerprintAsBitVect(m, 3, useFeatures=True, nBits=nbits)
fpFunc_dict['lecfp4'] = lambda m: AllChem.GetMorganFingerprintAsBitVect(m, 2, nBits=longbits)
fpFunc_dict['lecfp6'] = lambda m: AllChem.GetMorganFingerprintAsBitVect(m, 3, nBits=longbits)
fpFunc_dict['lfcfp4'] = lambda m: AllChem.GetMorganFingerprintAsBitVect(m, 2, useFeatures=True, nBits=longbits)
fpFunc_dict['lfcfp6'] = lambda m: AllChem.GetMorganFingerprintAsBitVect(m, 3, useFeatures=True, nBits=longbits)
fpFunc_dict['maccs'] = lambda m: MACCSkeys.GenMACCSKeys(m)
fpFunc_dict['hashap'] = lambda m: rdMolDescriptors.GetHashedAtomPairFingerprintAsBitVect(m, nBits=nbits)
fpFunc_dict['hashtt'] = lambda m: rdMolDescriptors.GetHashedTopologicalTorsionFingerprintAsBitVect(m, nBits=nbits)
fpFunc_dict['avalon'] = lambda m: fpAvalon.GetAvalonFP(m, nbits)
fpFunc_dict['laval'] = lambda m: fpAvalon.GetAvalonFP(m, longbits)
fpFunc_dict['rdk5'] = lambda m: Chem.RDKFingerprint(m, maxPath=5, fpSize=nbits, nBitsPerHash=2)
fpFunc_dict['rdk6'] = lambda m: Chem.RDKFingerprint(m, maxPath=6, fpSize=nbits, nBitsPerHash=2)
fpFunc_dict['rdk7'] = lambda m: Chem.RDKFingerprint(m, maxPath=7, fpSize=nbits, nBitsPerHash=2)

long_fps = {'laval', 'lecfp4', 'lecfp6', 'lfcfp4', 'lfcfp6'}
fps_to_generate = ['ecfp0','rdk5','lecfp6','hashtt','ecfp2','laval','maccs','hashap','fcfp4','avalon','ecfp4','ecfp6','rdk7','lecfp4','lfcfp6','lfcfp4']

dict_all = {}
ModFileName_LoadedModel_dict = {}
